# 이커머스 재고 도메인 모델

## 재고 (Stock)

*Entity*

### 속성

- **id : String** (UUID 기반 고유 식별자)
- **productId : String** (상품 식별자)
- **quantity : Long** (현재 재고 수량)
- **createdAt : LocalDateTime** (생성 시간)
- **updatedAt : LocalDateTime** (수정 시간)

### 행위

#### 정적 팩토리 메서드
- **register(productId, quantity) : Stock**
    - 새로운 상품의 재고를 등록합니다.
    - UUID를 자동 생성하여 id를 설정합니다.
    - 생성 시간과 수정 시간을 현재 시간으로 설정합니다.

#### 인스턴스 메서드
- **increaseQuantity(quantity) : void**
    - 기존 재고에 수량을 추가합니다.
    - 수정 시간을 현재 시간으로 업데이트합니다.

- **decreaseQuantity(quantity) : void**
    - 기존 재고에서 수량을 차감합니다.
    - 수정 시간을 현재 시간으로 업데이트합니다.

- **checkQuantity() : Long**
    - 현재 재고 수량을 반환합니다.

- **empty() : void**
    - 재고를 0으로 비웁니다.
    - 수정 시간을 현재 시간으로 업데이트합니다.

### 비즈니스 규칙

#### 등록 규칙
- 재고를 등록할 때, 수량은 0보다 커야 합니다.
- 재고를 등록할 때, 상품 ID는 null이 될 수 없습니다.
- 재고를 등록할 때, 수량은 null이 될 수 없습니다.

#### 수량 변경 규칙
- 재고를 증가시키거나 감소시키는 수량은 0보다 커야 합니다.
- 재고를 증가시키거나 감소시키는 수량은 null이 될 수 없습니다.
- 재고를 감소시킬 때, 요청 수량은 현재 재고보다 많을 수 없습니다.

#### 예외 처리
- 규칙 위반 시 `IllegalArgumentException`을 발생시킵니다.
- 상품 ID가 null인 경우 `NullPointerException`을 발생시킵니다.

### 도메인 서비스 연동

#### Application Layer (Ports & Adapters)
- **StockRegister** (Provided Port): 재고 등록 및 수량 변경
- **StockFinder** (Provided Port): 재고 조회
- **StockRepository** (Required Port): 데이터 영속성

#### 핵심 비즈니스 로직
- 재고 수량의 무결성 보장
- 재고 변경 이력 추적 (updatedAt)
- 도메인 규칙을 통한 비즈니스 제약 조건 강제

### 향후 확장 가능성

#### 예약 재고 시스템
- 가용 재고 (availableQuantity)
- 예약 재고 (reservedQuantity)
- 총 재고 (totalQuantity = availableQuantity + reservedQuantity)

#### 재고 상태 관리
- AVAILABLE: 재고 있음
- OUT_OF_STOCK: 재고 없음
- RESERVED: 예약됨

#### 주문 연동
- 주문 확정 시 예약 재고를 가용 재고로 전환
- 결제 성공 시 가용 재고 차감
- 결제 실패 시 예약 재고 해제
